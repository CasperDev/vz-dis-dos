<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5. Programming tips &mdash; Laser310/VZ300 DOS 1.2 1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Application example" href="../Chapter6/index.html" />
    <link rel="prev" title="4. Error Messages" href="../Chapter4/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Laser310/VZ300 DOS 1.2
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../test.html">Siała baba mak</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter0/index.html">0. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter1/index.html">1. The LASER 110, 210 and 310 Disk System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter2/index.html">2. DOS Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter3/index.html">3. The individual DOS commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter4/index.html">4. Error Messages</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Programming tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter6/index.html">6. Application example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter7/index.html">7. Technical Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter8/index.html">8. Communication between the DOS and the Floppy Disk Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter9/index.html">9. The most important DOS routines and their application іп machine programs.</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Laser310/VZ300 DOS 1.2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">5. Programming tips</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Chapter5/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="programming-tips">
<h1>5. Programming tips<a class="headerlink" href="#programming-tips" title="Permalink to this heading"></a></h1>
<div class="error admonition hint">
<p class="admonition-title">Hint</p>
<p class="linemarker linemarker-7">Tip 1</p>
</div>
<p class="linemarker linemarker-10">As already mentioned in the description of the last sections, there is the
problem that when a program is aborted due to an error or the BREAK key,
not all files are necessarily closed correctly.</p>
<p class="linemarker linemarker-14">A restart of such a program after error correction or similar usually leads to the
message <code class="docutils literal notranslate"><span class="pre">?FILE</span> <span class="pre">ALREADY</span> <span class="pre">OPEN</span></code>.</p>
<p class="linemarker linemarker-17">You can now manually complete these files in direct mode if their names are
known.</p>
<p class="linemarker linemarker-20">However, this is not sufficient for new files to be created in a program. Such
files must then also be deleted, otherwise the file will be updated when OPEN
is repeated and you will have your data in the file more than once.
In all these cases, the following procedure is recommended:</p>
<p class="linemarker linemarker-25">At the end of all programs under development you define a block with
CLOSE calls and possibly also delete calls for all files addressed in the
program. If the program is interrupted as mentioned above, simply call
this routine with RUN line number.</p>
<p class="linemarker linemarker-30">In a program, you edit the three files DAT1, DAT2 for reading, and
DAT3 is recreated.</p>
<div class="hint highlight-BASIC notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="o">...</span><span class="w">           </span><span class="vg">own</span><span class="w"> </span><span class="vg">program</span>
<span class="o">...</span>
<span class="nl">4800</span><span class="w"> </span><span class="kr">END</span>
<span class="nl">20000</span><span class="w"> </span><span class="kr">CLOSE</span><span class="w"> </span><span class="s2">&quot;DAT1&quot;</span>
<span class="nl">20010</span><span class="w"> </span><span class="kr">CLOSE</span><span class="w"> </span><span class="s2">&quot;DAT2&quot;</span>
<span class="nl">20020</span><span class="w"> </span><span class="kr">CLOSE</span><span class="w"> </span><span class="s2">&quot;DAT3&quot;</span>
<span class="nl">20030</span><span class="w"> </span><span class="vg">ERA</span><span class="w"> </span><span class="s2">&quot;DAT3&quot;</span>
<span class="nl">20040</span><span class="w"> </span><span class="kr">END</span>
</pre></div>
</div>
<p class="linemarker linemarker-46">If a program is interrupted, you can use RUN 20000 to clean up your
files and restart your program without any problems after correction.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p class="linemarker linemarker-51">Tip 2</p>
</div>
<p class="linemarker linemarker-53">It is often necessary that a file must be present on the diskette when the
program is started (see program example “Address Directory”), although it
does not contain any data afterwards.</p>
<p class="linemarker linemarker-57">Apply a similar technique to chen by defining the following lines at the end of
the actual program:</p>
<div class="hint highlight-BASIC notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="o">...</span><span class="w">           </span><span class="vg">own</span><span class="w"> </span><span class="vg">program</span>
<span class="o">...</span>
<span class="nl">6000</span><span class="w"> </span><span class="kr">END</span>
<span class="nl">10000</span><span class="w"> </span><span class="kr">OPEN</span><span class="w"> </span><span class="s2">&quot;MAILBOX&quot;</span><span class="p">,</span><span class="il">1</span>
<span class="nl">10010</span><span class="w"> </span><span class="kr">CLOSE</span><span class="w"> </span><span class="s2">&quot;MAILBOX&quot;</span>
<span class="nl">10020</span><span class="w"> </span><span class="kr">END</span>
</pre></div>
</div>
<p class="linemarker linemarker-72">With RUN 10000 you create an empty file “MAILBOX” on the floppy disk.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p class="linemarker linemarker-74">Tip 3</p>
</div>
<p class="linemarker linemarker-76">A bottleneck of LASER-D0S is that the file names must be specified directly in
the commands and cannot be replaced by variables.</p>
<p class="linemarker linemarker-79">How can you still edit different files in one program?</p>
<p class="linemarker linemarker-81">Knowledge of the BASIC program structure is required to understand the
following solution.</p>
<p class="linemarker linemarker-84">Here are the most important points:</p>
<ul>
<li><p class="linemarker linemarker-86">The start address of a BASIC program can be found in memory
locations 78A4H and 78A5H (30884 and 30885 decimal).</p></li>
<li><p class="linemarker linemarker-88">A BASIC line has the following structure:</p>
<ul class="simple">
<li><p class="linemarker linemarker-90">2 bytes - pointer to the next line</p></li>
<li><p class="linemarker linemarker-91">2 bytes - line number</p></li>
<li><p class="linemarker linemarker-92">n bytes - line text</p></li>
<li><p class="linemarker linemarker-93">1 byte - line end identifier (Х’00”)</p></li>
</ul>
<p class="linemarker linemarker-95">BASIC keywords contained in line text, apart from the DOS commands,
are represented in the text as one-character “TOKENS”.
The space inserted between the line number and the line text in a
program listing is not part of the line.</p>
</li>
</ul>
<p class="linemarker linemarker-100">If these conditions are taken into account, the example below can be easily
understood and reproduced.</p>
<p class="linemarker linemarker-103">The main point of this example is that all file calls are located at the beginning
of the program, so they can be counted more easily and are not shifted when
the program is changed later.</p>
<p class="linemarker linemarker-107">After selection by the user, a program evaluates one of three possible files
DAT1, DAT2 or DAT3.</p>
<div class="hint highlight-BASIC notranslate"><div class="highlight"><pre><span></span><span class="nl">10</span><span class="w"> </span><span class="kr">GOTO</span><span class="w"> </span><span class="nl">100</span>
<span class="nl">20</span><span class="w"> </span><span class="kr">OPEN</span><span class="w"> </span><span class="s2">&quot;DAT1&quot;</span><span class="p">,</span><span class="il">0</span><span class="o">:</span><span class="kr">RETURN</span>
<span class="nl">30</span><span class="w"> </span><span class="vg">IN#</span><span class="w"> </span><span class="s2">&quot;DAT1&quot;</span><span class="p">,</span><span class="vg">A$</span><span class="o">.</span><span class="vg">B$</span><span class="p">,</span><span class="nl">C:</span><span class="kr">RETURN</span>
<span class="nl">40</span><span class="w"> </span><span class="kr">CLOSE</span><span class="w"> </span><span class="s2">&quot;DAT1&quot;</span><span class="o">:</span><span class="kr">RETURN</span>
<span class="nl">100</span><span class="w"> </span><span class="kr">CLEAR</span><span class="w"> </span><span class="il">1000</span>
<span class="nl">110</span><span class="w"> </span><span class="vg">A</span><span class="o">=</span><span class="kr">PEEK</span><span class="p">(</span><span class="il">30885</span><span class="p">)</span><span class="o">*</span><span class="il">256</span><span class="o">+</span><span class="kr">PEEK</span><span class="p">(</span><span class="il">30884</span><span class="p">)</span>
<span class="nl">120</span><span class="w"> </span><span class="kr">CLS</span>
<span class="nl">130</span><span class="w"> </span><span class="kr">INPUT</span><span class="w"> </span><span class="s2">&quot;FILE VERSION (1-3)&quot;</span><span class="p">;</span><span class="vg">X$</span>
<span class="nl">140</span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="vg">X$</span><span class="o">&lt;</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="vg">X$</span><span class="o">&gt;</span><span class="s2">&quot;3&quot;</span><span class="w"> </span><span class="kr">THEN</span><span class="w"> </span><span class="il">120</span>
<span class="nl">150</span><span class="w"> </span><span class="kr">POKE</span><span class="w"> </span><span class="vg">A</span><span class="o">+</span><span class="il">23</span><span class="p">,</span><span class="kr">ASC</span><span class="p">(</span><span class="vg">X$</span><span class="p">)</span>
<span class="nl">160</span><span class="w"> </span><span class="kr">POKE</span><span class="w"> </span><span class="vg">A</span><span class="o">+</span><span class="il">42</span><span class="p">,</span><span class="kr">ASC</span><span class="p">(</span><span class="vg">X$</span><span class="p">)</span>
<span class="nl">170</span><span class="w"> </span><span class="kr">POKE</span><span class="w"> </span><span class="vg">A</span><span class="o">+</span><span class="il">69</span><span class="p">,</span><span class="kr">ASC</span><span class="p">(</span><span class="vg">X$</span><span class="p">)</span>
<span class="nl">180</span><span class="w"> </span><span class="kr">GOSUB</span><span class="w"> </span><span class="nl">20</span>
<span class="nl">190</span><span class="w"> </span><span class="kr">GOSUB</span><span class="w"> </span><span class="nl">30</span>
<span class="o">...</span>
<span class="o">...</span><span class="w">      </span><span class="vg">edit</span><span class="w"> </span><span class="vg">the</span><span class="w"> </span><span class="vg">data</span><span class="p">,</span><span class="w"> </span><span class="vg">if</span><span class="w"> </span><span class="vg">necessary</span><span class="w"> </span><span class="vg">several</span><span class="w"> </span><span class="vg">records</span>
<span class="o">...</span><span class="w">      </span><span class="vg">read</span><span class="w"> </span><span class="vg">with</span><span class="w"> </span><span class="kr">GOSUB</span><span class="w"> </span><span class="nl">30</span>
<span class="o">...</span>
<span class="nl">400</span><span class="w"> </span><span class="kr">GOSUB</span><span class="w"> </span><span class="nl">40</span>
<span class="nl">410</span><span class="w"> </span><span class="kr">END</span>
</pre></div>
</div>
<p class="linemarker linemarker-135">Line 10 jumps to the actual beginning of the program.</p>
<p class="linemarker linemarker-137">In lines 20, 30 and 40 the file calls are defined as individual subroutines.</p>
<p class="linemarker linemarker-139">The program start address is determined in line 110.</p>
<p class="linemarker linemarker-141">Lines 130 and 140 ask for the desired file version.</p>
<p class="linemarker linemarker-143">If correct, this is transferred to the file names of lines 20, 30 and 40 in lines
150, 160 and 170.</p>
<p class="linemarker linemarker-146">Lines 180, 190 and 400 indicate file processing by calling subroutines as an
example.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../Chapter4/index.html" class="btn btn-neutral float-left" title="4. Error Messages" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Chapter6/index.html" class="btn btn-neutral float-right" title="6. Application example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1984, Gerhard Wolf (translation 2023, Casper).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>